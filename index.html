<!doctype html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Dare to Read ‚Äì H√†nh tr√¨nh 21 ng√†y ƒë·ªçc s√°ch</title>
  <style>
    :root{
      --vtb-blue:#003A8C;
      --vtb-cyan:#00AEEF;
      --vtb-red:#E60012;

      --ink:#0b1220;
      --muted: rgba(11,18,32,.60);

      --card: rgba(255,255,255,.92);
      --card2: rgba(255,255,255,.78);

      --shadow: 0 18px 50px rgba(0,0,0,.18);
      --radius: 18px;

      --ok:#12b981;
      --warn:#f59e0b;
      --err:#ef4444;
      --btn:#0b5cc7;
      --btn2:#0a4ca6;
    }

    html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;color:var(--ink);}
    body{
      background:
        radial-gradient(1100px 700px at 20% 20%, rgba(0,174,239,.22), transparent 55%),
        radial-gradient(900px 650px at 85% 15%, rgba(230,0,18,.16), transparent 55%),
        linear-gradient(135deg, rgba(0,58,140,.85), rgba(0,174,239,.35) 40%, rgba(230,0,18,.20));
      min-height:100vh;
      padding: env(safe-area-inset-top) 0 env(safe-area-inset-bottom);
    }

    /* layout */
    .wrap{
      width: min(560px, 100%);
      margin: 0 auto;
      padding: 14px 12px 24px;
      box-sizing: border-box;
    }
    .topbar{
      display:flex; align-items:center; justify-content:space-between;
      background: linear-gradient(90deg, rgba(255,255,255,.18), rgba(255,255,255,.10));
      border: 1px solid rgba(255,255,255,.25);
      border-radius: 18px;
      padding: 10px 12px;
      backdrop-filter: blur(10px);
      box-shadow: 0 10px 28px rgba(0,0,0,.12);
    }
    .brand{display:flex; gap:10px; align-items:center;}
    .logo{
      width:36px;height:36px;border-radius:12px;
      background: conic-gradient(from 220deg, var(--vtb-blue), var(--vtb-cyan), var(--vtb-red), var(--vtb-blue));
      box-shadow: 0 10px 25px rgba(0,0,0,.18);
      position:relative;
    }
    .logo:after{
      content:"";
      position:absolute; inset:9px;
      border-radius:9px;
      background: rgba(255,255,255,.18);
      border: 1px solid rgba(255,255,255,.35);
    }
    .brand h1{font-size:15px; margin:0; line-height:1.15; color:#fff; letter-spacing:.2px;}
    .brand p{font-size:12px; margin:2px 0 0; color: rgba(255,255,255,.78);}
    .actions{display:flex; gap:8px; align-items:center; flex-wrap:wrap; justify-content:flex-end;}
    .pill{
      border: 1px solid rgba(255,255,255,.30);
      background: rgba(255,255,255,.14);
      color: #fff;
      padding: 7px 10px;
      border-radius: 999px;
      font-weight: 650;
      font-size: 12px;
      cursor:pointer;
      user-select:none;
      transition: .15s ease;
      display:inline-flex; gap:8px; align-items:center;
    }
    .pill:active{transform: translateY(1px);}
    .pill.primary{background: rgba(255,255,255,.92); color:#0b1220; border-color: rgba(255,255,255,.85);}
    .pill.danger{background: rgba(239,68,68,.92); border-color: rgba(239,68,68,.92);}
    .pill.ghost{background: rgba(255,255,255,.10);}
    .pill.small{padding:6px 9px; font-size:12px;}
    .pill.disabled{opacity:.55; pointer-events:none;}

    .card{
      margin-top: 12px;
      background: var(--card);
      border: 1px solid rgba(255,255,255,.65);
      border-radius: 22px;
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .cardInner{padding:14px 14px 14px;}
    .titleRow{display:flex; align-items:flex-start; justify-content:space-between; gap:10px;}
    .titleRow h2{margin:0; font-size:18px;}
    .subtitle{margin:6px 0 0; color: var(--muted); font-size:13px; line-height:1.35;}
    .statsRow{display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px; margin-top:10px;}
    .stat{
      background: rgba(255,255,255,.70);
      border: 1px solid rgba(11,18,32,.08);
      border-radius: 16px;
      padding:10px 10px;
      min-height:56px;
    }
    .stat .k{font-size:11px; color: rgba(11,18,32,.62); font-weight:650;}
    .stat .v{margin-top:4px; font-size:16px; font-weight:850;}
    .badge{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px;
      border-radius: 999px;
      border: 1px solid rgba(11,18,32,.10);
      background: rgba(255,255,255,.78);
      font-weight:800;
      font-size:13px;
      white-space:nowrap;
    }

    /* Journey grid */
    .section{margin-top:12px;}
    .section h3{margin:0 0 8px; font-size:15px;}
    .grid{
      display:grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 10px;
    }
    @media (max-width:420px){
      .grid{grid-template-columns: repeat(3, 1fr);}
    }
    .day{
      border-radius: 16px;
      padding: 10px 10px;
      background: rgba(255,255,255,.78);
      border: 1px solid rgba(11,18,32,.10);
      cursor:pointer;
      user-select:none;
      position:relative;
      min-height: 62px;
      display:flex; flex-direction:column; justify-content:space-between;
      transition:.12s ease;
    }
    .day:active{transform: translateY(1px);}
    .day .d{font-weight:900; font-size:13px;}
    .day .s{font-size:11px; color: rgba(11,18,32,.60); font-weight:700;}

    .day.completed{
      background: rgba(18,185,129,.14);
      border-color: rgba(18,185,129,.30);
    }
    .tick{
      position:absolute; top:8px; right:8px;
      width:18px; height:18px; border-radius:999px;
      background: rgba(18,185,129,.92);
      display:none;
      box-shadow: 0 10px 22px rgba(18,185,129,.25);
    }
    .tick:after{
      content:"";
      position:absolute;
      left:6px; top:4px;
      width:5px; height:9px;
      border-right:2px solid #fff;
      border-bottom:2px solid #fff;
      transform: rotate(45deg);
    }
    .day.completed .tick{display:block;}

    .day.current{
      border-color: rgba(245,158,11,.55);
      background: rgba(245,158,11,.10);
      box-shadow: 0 0 0 4px rgba(245,158,11,.12);
      animation: pulse 1.15s infinite ease-in-out;
    }
    @keyframes pulse{
      0%{transform:scale(1);}
      50%{transform:scale(1.02);}
      100%{transform:scale(1);}
    }
    .day.locked{
      opacity:.45;
      filter: grayscale(.1);
      cursor:not-allowed;
    }

    /* Leaderboard */
    .lbBox{
      margin-top: 12px;
      background: rgba(255,255,255,.70);
      border: 1px solid rgba(11,18,32,.10);
      border-radius: 18px;
      overflow:hidden;
    }
    .lbHead{
      padding:10px 12px;
      display:flex; align-items:center; justify-content:space-between; gap:8px;
      border-bottom:1px solid rgba(11,18,32,.08);
      background: rgba(255,255,255,.55);
    }
    .lbHead .t{font-weight:900; font-size:13px;}
    .lbHead .m{font-size:12px; color: rgba(11,18,32,.60); font-weight:700;}
    .lbRow{
      display:grid;
      grid-template-columns: 34px 1fr 90px;
      gap:10px;
      padding:10px 12px;
      border-bottom:1px solid rgba(11,18,32,.06);
      align-items:center;
    }
    .lbRow:last-child{border-bottom:0;}
    .lbRow .rk{font-weight:900;}
    .lbRow .u{font-weight:850;}
    .lbRow .p{
      text-align:right;
      font-weight:900;
      display:flex; gap:8px; align-items:center; justify-content:flex-end;
    }
    .star{width:16px;height:16px; display:inline-block;}
    .star svg{display:block;}

    .meRank{
      margin-top: 10px;
      background: rgba(0,58,140,.08);
      border: 1px solid rgba(0,58,140,.18);
      border-radius: 16px;
      padding: 10px 12px;
      display:flex; justify-content:space-between; align-items:center; gap:10px;
    }
    .meRank .a{font-weight:900;}
    .meRank .b{font-weight:900;}

    /* Day screen */
    .textarea{
      width:100%;
      border-radius: 16px;
      border: 1px solid rgba(11,18,32,.12);
      padding: 12px 12px;
      box-sizing: border-box;
      font-size: 14px;
      line-height: 1.45;
      min-height: 150px;
      outline:none;
      resize: vertical;
      background: rgba(255,255,255,.92);
    }
    .btnRow{margin-top:10px; display:flex; justify-content:flex-end;}
    .btn{
      border:0;
      cursor:pointer;
      border-radius: 999px;
      padding: 10px 14px;
      font-weight:900;
      color:#fff;
      background: linear-gradient(135deg, var(--btn), var(--btn2));
      box-shadow: 0 14px 28px rgba(11,92,199,.20);
      display:inline-flex; gap:8px; align-items:center;
    }
    .btn:active{transform: translateY(1px);}
    .btn[disabled]{opacity:.6; pointer-events:none;}

    /* Quote */
    .quote{
      margin-top:12px;
      border-left: 4px solid rgba(0,174,239,.55);
      background: rgba(0,174,239,.10);
      border-radius: 14px;
      padding: 10px 12px;
      color: rgba(11,18,32,.78);
      font-style: italic;
    }
    .quote small{display:block; margin-top:6px; font-style:normal; color: rgba(11,18,32,.55); font-weight:700;}

    /* Admin */
    .tabs{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
      margin-top:10px;
    }
    .tab{
      background: rgba(255,255,255,.72);
      border: 1px solid rgba(11,18,32,.10);
      border-radius: 16px;
      padding: 10px 12px;
      font-weight:900;
      cursor:pointer;
      user-select:none;
      display:flex; gap:10px; align-items:center; justify-content:center;
    }
    .tab.active{
      background: rgba(11,18,32,.90);
      color:#fff;
      border-color: rgba(11,18,32,.90);
    }

    .adminBox{margin-top:12px;}
    .miniHelp{
      margin:8px 0 0;
      color: rgba(11,18,32,.62);
      font-size: 12px;
      line-height: 1.35;
    }
    .table{
      width:100%;
      border-collapse:collapse;
      overflow:hidden;
      border-radius: 16px;
      background: rgba(255,255,255,.78);
      border: 1px solid rgba(11,18,32,.10);
    }
    .table th,.table td{
      padding: 10px 10px;
      border-bottom: 1px solid rgba(11,18,32,.06);
      text-align:left;
      font-size: 13px;
    }
    .table th{
      font-size: 12px;
      text-transform:none;
      letter-spacing:.2px;
      color: rgba(11,18,32,.65);
      background: rgba(255,255,255,.55);
      font-weight:900;
    }
    .table tr:last-child td{border-bottom:0;}
    .right{text-align:right;}
    .center{text-align:center;}

    /* Toast */
    .toast{
      position: fixed;
      left: 50%;
      bottom: 14px;
      transform: translateX(-50%);
      background: rgba(11,18,32,.92);
      color: #fff;
      padding: 10px 12px;
      border-radius: 999px;
      font-weight: 800;
      font-size: 12px;
      box-shadow: 0 18px 40px rgba(0,0,0,.25);
      opacity: 0;
      pointer-events:none;
      transition: .18s ease;
      max-width: min(560px, calc(100vw - 24px));
      white-space: nowrap;
      overflow:hidden;
      text-overflow: ellipsis;
      z-index: 9999;
    }
    .toast.show{opacity:1; transform: translateX(-50%) translateY(-2px);}
    .toast.ok{background: rgba(18,185,129,.92);}
    .toast.err{background: rgba(239,68,68,.92);}
    .toast.warn{background: rgba(245,158,11,.92); color:#111;}

    /* Small utility */
    .hide{display:none !important;}
    .muted{color: rgba(11,18,32,.60);}
    .divider{height:1px;background:rgba(11,18,32,.08); margin:12px 0;}
  </style>
</head>

<body>
  <div class="wrap">
    <!-- TOPBAR -->
    <div class="topbar">
      <div class="brand">
        <div class="logo" aria-hidden="true"></div>
        <div>
          <h1>Dare to Read</h1>
          <p>H√†nh tr√¨nh 21 ng√†y ƒë·ªçc s√°ch</p>
        </div>
      </div>
      <div class="actions" id="topActions">
        <button class="pill ghost small hide" id="btnBack">‚Üê Quay l·∫°i</button>
        <button class="pill ghost small hide" id="btnAdminTop">Admin</button>
        <button class="pill ghost small hide" id="btnUserTag"></button>
        <button class="pill danger small hide" id="btnLogout">ƒêƒÉng xu·∫•t</button>
      </div>
    </div>

    <!-- LOGIN -->
    <div class="card" id="screenLogin">
      <div class="cardInner">
        <div class="titleRow">
          <div>
            <h2>ƒêƒÉng nh·∫≠p</h2>
            <div class="subtitle">Nh·∫≠p t√†i kho·∫£n ƒë·ªÉ b·∫Øt ƒë·∫ßu h√†nh tr√¨nh. M·ªói ng√†y ho√†n th√†nh ƒë∆∞·ª£c <b>+1 ƒëi·ªÉm</b>.</div>
          </div>
          <span class="badge" title="M·ªói ng√†y +1 ƒëi·ªÉm">‚≠ê +1 / ng√†y</span>
        </div>

        <div class="section" style="margin-top:12px;">
          <div class="subtitle" style="margin:0 0 8px;">T√†i kho·∫£n</div>
          <input id="inpUser" class="textarea" style="min-height:46px;resize:none;" placeholder="V√≠ d·ª•: demo01" />
          <div style="height:10px"></div>
          <div class="subtitle" style="margin:0 0 8px;">M·∫≠t kh·∫©u</div>
          <input id="inpPass" type="password" class="textarea" style="min-height:46px;resize:none;" placeholder="Nh·∫≠p m·∫≠t kh·∫©u" />
          <div style="display:flex; justify-content:space-between; gap:10px; align-items:center; margin-top:12px;">
            <button class="pill ghost" id="btnOpenAdminFromLogin">üîß Admin</button>
            <button class="pill primary" id="btnLogin">ƒêƒÉng nh·∫≠p ‚Üí</button>
          </div>
          <div class="miniHelp">
            G·ª£i √Ω: N·∫øu S·∫øp ƒëang m·ªü file HTML d·∫°ng <b>file://</b>, h·ªá th·ªëng s·∫Ω d√πng <b>JSONP</b> ƒë·ªÉ l∆∞u d·ªØ li·ªáu (kh√¥ng b·ªã CORS).
          </div>
        </div>
      </div>
    </div>

    <!-- HOME (PLAYER) -->
    <div class="card hide" id="screenHome">
      <div class="cardInner">
        <div class="titleRow">
          <div>
            <h2 id="helloTitle">Xin ch√†o!</h2>
            <div class="subtitle">H√£y ch·ªçn ng√†y ƒë·ªÉ ghi l·∫°i n·ªôi dung ƒë√£ ƒë·ªçc nh√©. B·∫°n ch·ªâ ƒë∆∞·ª£c v√†o <b>ƒë√∫ng ng√†y hi·ªán t·∫°i</b> (kh√¥ng nh·∫£y ng√†y).</div>
          </div>
          <span class="badge" id="pointBadge">‚≠ê ƒêi·ªÉm: 0</span>
        </div>

        <div class="statsRow">
          <div class="stat">
            <div class="k">üèÖ H·∫°ng c·ªßa b·∫°n</div>
            <div class="v" id="meRank">-</div>
          </div>
          <div class="stat">
            <div class="k">‚≠ê ƒêi·ªÉm</div>
            <div class="v" id="mePoint">0</div>
          </div>
          <div class="stat">
            <div class="k">üìÖ Ng√†y hi·ªán t·∫°i</div>
            <div class="v" id="currentDay">1</div>
          </div>
        </div>

        <div class="section">
          <h3>H√†nh tr√¨nh 21 ng√†y</h3>
          <div class="grid" id="dayGrid"></div>
          <div class="miniHelp">
            ‚úÖ Ng√†y ƒë√£ l√†m: tick xanh ‚Ä¢ üü† Ng√†y hi·ªán t·∫°i: nh·∫•p nh√°y ‚Ä¢ üîí Ng√†y ch∆∞a t·ªõi: m·ªù ƒëi
          </div>
        </div>

        <!-- Leaderboard MUST be under journey -->
        <div class="section">
          <div class="lbBox">
            <div class="lbHead">
              <div class="t">üèÜ B·∫£ng x·∫øp h·∫°ng</div>
              <div class="m" id="lbMeta">Top 3</div>
            </div>
            <div id="lbRows"></div>
          </div>

          <div class="meRank">
            <div class="a">Th·ª© h·∫°ng c·ªßa b·∫°n</div>
            <div class="b" id="meRankLine">-</div>
          </div>
        </div>
      </div>
    </div>

    <!-- DAY SCREEN -->
    <div class="card hide" id="screenDay">
      <div class="cardInner">
        <div class="titleRow">
          <div>
            <h2 id="dayTitle">Ng√†y 1</h2>
            <div class="subtitle">Chia s·∫ª ƒëi·ªÅu b·∫°n t√¢m ƒë·∫Øc trong n·ªôi dung ƒë√£ ƒë·ªçc (t·ªëi thi·ªÉu 15 k√Ω t·ª±). Nh·∫•n <b>Ho√†n th√†nh</b> ƒë·ªÉ t·ª± ƒë·ªông l∆∞u & quay v·ªÅ trang ch·ªß.</div>
          </div>
          <span class="badge">‚≠ê ƒêi·ªÉm: 1</span>
        </div>

        <div class="section" style="margin-top:12px;">
          <textarea id="txtContent" class="textarea" placeholder="H√¥m nay t√¥i ƒë·ªçc..."></textarea>
          <div class="btnRow">
            <button class="btn" id="btnFinish">Ho√†n th√†nh</button>
          </div>
          <div class="quote" id="quoteBox">
            ‚Äúƒê·ªçc s√°ch l√† h·ªçc su·ªët ƒë·ªùi.‚Äù
            <small>‚Äî Danh ng√¥n</small>
          </div>
        </div>
      </div>
    </div>

    <!-- ADMIN -->
    <div class="card hide" id="screenAdmin">
      <div class="cardInner">
        <div class="titleRow">
          <div>
            <h2>üõ† Admin Console ‚Äì Dare to Read</h2>
            <div class="subtitle">Qu·∫£n l√Ω t√†i kho·∫£n (theo Sheet), c·∫•u h√¨nh Web App, dashboard to√†n b·ªô ng∆∞·ªùi ch∆°i.</div>
          </div>
          <span class="badge" id="adminBadge">Admin</span>
        </div>

        <div class="section" style="margin-top:10px;">
          <div class="subtitle" style="margin:0 0 8px;">Admin password</div>
          <input id="inpAdminPass" type="password" class="textarea" style="min-height:46px;resize:none;" placeholder="Nh·∫≠p admin password" />
          <div class="miniHelp">G·ª£i √Ω: n·∫øu mu·ªën t·∫°o account h√†ng lo·∫°t, ch·ªâ c·∫ßn d√°n danh s√°ch v√†o Sheet <b>Accounts</b>.</div>
        </div>

        <div class="tabs">
          <div class="tab active" data-tab="dash">üìä Dashboard</div>
          <div class="tab" data-tab="acc">üë• T√†i kho·∫£n</div>
          <div class="tab" data-tab="web">üßæ Web App / Sheet</div>
          <div class="tab" data-tab="reset">‚ôªÔ∏è Reset</div>
        </div>

        <!-- DASH -->
        <div class="adminBox" id="adminDash">
          <div class="subtitle"><b>Th·ª© h·∫°ng</b> theo ƒëi·ªÉm & th·ªùi gian ƒë·∫°t m·ªëc ƒëi·ªÉm (ƒë·∫°t s·ªõm h∆°n x·∫øp cao h∆°n khi b·∫±ng ƒëi·ªÉm).</div>

          <div style="margin-top:10px;">
            <table class="table" id="dashTable">
              <thead>
                <tr>
                  <th style="width:42px;">#</th>
                  <th>User</th>
                  <th class="center" style="width:90px;">ƒêi·ªÉm</th>
                  <th style="width:160px;">M·ªëc ƒëi·ªÉm ƒë·∫°t l√∫c</th>
                </tr>
              </thead>
              <tbody id="dashBody"></tbody>
            </table>
          </div>

          <div class="divider"></div>

          <h3 style="margin:0 0 8px;">S·ªë l∆∞·ª£ng ng∆∞·ªùi tham gia theo ng√†y</h3>
          <table class="table">
            <thead>
              <tr>
                <th>Ng√†y</th>
                <th class="right">S·ªë ng∆∞·ªùi ƒë√£ tham gia</th>
              </tr>
            </thead>
            <tbody id="dayStatBody"></tbody>
          </table>

          <div class="miniHelp" id="dashMeta" style="margin-top:8px;"></div>

          <div style="display:flex; justify-content:flex-end; margin-top:10px;">
            <button class="pill primary" id="btnReloadDash">T·∫£i l·∫°i</button>
          </div>
        </div>

        <!-- ACC -->
        <div class="adminBox hide" id="adminAcc">
          <div class="subtitle">
            T·∫°o account theo l√¥: <b>ch·ªâ c·∫ßn add danh s√°ch v√†o Sheet Accounts</b> (user | password | avatar).
          </div>
          <div style="margin-top:10px;">
            <button class="pill primary" id="btnLoadAccounts">T·∫£i danh s√°ch Accounts</button>
          </div>
          <div style="margin-top:10px;">
            <table class="table">
              <thead>
                <tr>
                  <th>User</th>
                  <th class="center" style="width:90px;">Avatar</th>
                </tr>
              </thead>
              <tbody id="accBody"></tbody>
            </table>
          </div>
        </div>

        <!-- WEB -->
        <div class="adminBox hide" id="adminWeb">
          <div class="subtitle">
            Web App URL ƒëang d√πng (copy ƒë√∫ng URL v√†o HTML). N√™n deploy: <b>Execute as: Me</b> v√† <b>Who has access: Anyone</b>.
          </div>

          <div class="section" style="margin-top:10px;">
            <div class="subtitle" style="margin:0 0 8px;">Web App URL</div>
            <input id="inpWebAppUrl" class="textarea" style="min-height:46px;resize:none;" />
            <div style="display:flex; gap:10px; margin-top:10px; flex-wrap:wrap;">
              <button class="pill primary" id="btnCopyUrl">Copy URL</button>
              <button class="pill ghost" id="btnTestPing">Test ping</button>
              <button class="pill ghost" id="btnTestDash">Test dashboard</button>
            </div>
            <div class="miniHelp" id="webHint" style="margin-top:8px;"></div>
          </div>
        </div>

        <!-- RESET -->
        <div class="adminBox hide" id="adminReset">
          <div class="subtitle">
            Reset progress theo user (x√≥a log c·ªßa user trong Sheet Data). D√πng khi c·∫ßn.
          </div>
          <div style="margin-top:10px;">
            <input id="inpResetUser" class="textarea" style="min-height:46px;resize:none;" placeholder="Nh·∫≠p user c·∫ßn reset (vd: demo01)" />
            <div style="display:flex; justify-content:flex-end; margin-top:10px;">
              <button class="pill danger" id="btnResetUser">Reset user</button>
            </div>
            <div class="miniHelp muted">L∆∞u √Ω: thao t√°c n√†y s·∫Ω x√≥a to√†n b·ªô d√≤ng c·ªßa user trong Sheet Data.</div>
          </div>
        </div>
      </div>
    </div>

  </div>

  <div class="toast" id="toast"></div>

  <script>
    /***********************
     * CONFIG
     ***********************/
    const CONFIG = {
      WEB_APP_URL: "https://script.google.com/macros/s/AKfycbzMqP8mu5ltDrjwiKsp0ccdm7EC5UD4mNlJFuZn8Qh0_8jUEhFCSsQZEyguTEg8XTS3mQ/exec",
      MAX_DAYS: 21,
      LEADERBOARD_TOP: 3,
      MIN_LEN: 15,
      QUOTES: [
        { q: "ƒê·ªçc s√°ch l√† h·ªçc su·ªët ƒë·ªùi.", a: "Danh ng√¥n" },
        { q: "S√°ch l√† ng·ªçn ƒë√®n soi s√°ng tr√≠ tu·ªá.", a: "Danh ng√¥n" },
        { q: "M·ªôt ng√†y kh√¥ng ƒë·ªçc l√† m·ªôt ng√†y l√πi l·∫°i.", a: "Danh ng√¥n" },
        { q: "ƒê·ªçc √≠t nh∆∞ng hi·ªÉu s√¢u.", a: "Danh ng√¥n" },
        { q: "Tri th·ª©c b·∫Øt ƒë·∫ßu t·ª´ th√≥i quen ƒë·ªçc.", a: "Danh ng√¥n" },
{ q: "ƒê·ªçc s√°ch l√† c√°ch r·∫ª nh·∫•t ƒë·ªÉ ƒëi du l·ªãch kh·∫Øp th·∫ø gi·ªõi.", a: "Mark Twain" },
{ q: "Kh√¥ng c√≥ ng∆∞·ªùi b·∫°n n√†o trung th√†nh h∆°n m·ªôt cu·ªën s√°ch.", a: "Ernest Hemingway" },
{ q: "C√†ng ƒë·ªçc nhi·ªÅu, b·∫°n c√†ng bi·∫øt nhi·ªÅu; c√†ng bi·∫øt nhi·ªÅu, b·∫°n c√†ng ƒëi xa.", a: "Dr. Seuss" },
{ q: "M·ªôt cƒÉn ph√≤ng kh√¥ng c√≥ s√°ch gi·ªëng nh∆∞ m·ªôt c∆° th·ªÉ kh√¥ng c√≥ linh h·ªìn.", a: "Cicero" },
{ q: "S√°ch l√† ph√©p m√†u di ƒë·ªông c·ªßa con ng∆∞·ªùi.", a: "Stephen King" },
{ q: "Ng∆∞·ªùi kh√¥ng ƒë·ªçc s√°ch ch·ªâ s·ªëng m·ªôt cu·ªôc ƒë·ªùi; ng∆∞·ªùi ƒë·ªçc s√°ch s·ªëng ng√†n cu·ªôc ƒë·ªùi.", a: "George R. R. Martin" },
{ q: "ƒê·ªçc s√°ch cho tr√≠ √≥c c≈©ng nh∆∞ t·∫≠p th·ªÉ d·ª•c cho c∆° th·ªÉ.", a: "Joseph Addison" },
{ q: "S√°ch cho t√¥i m·ªôt n∆°i ƒë·ªÉ ƒëi khi t√¥i kh√¥ng th·ªÉ r·ªùi kh·ªèi ch·ªó ng·ªìi.", a: "Jhumpa Lahiri" },
{ q: "Khi b·∫°n d·ª´ng ƒë·ªçc, b·∫°n b·∫Øt ƒë·∫ßu t·ª•t l·∫°i ph√≠a sau.", a: "Mark Twain" },
{ q: "M·ªôt cu·ªën s√°ch ƒë√∫ng l√∫c c√≥ th·ªÉ thay ƒë·ªïi c·∫£ cu·ªôc ƒë·ªùi.", a: "Paulo Coelho" },
{ q: "H·ªçc t·∫≠p kh√¥ng bao gi·ªù l√†m tr√≠ √≥c m·ªát m·ªèi.", a: "Leonardo da Vinci" },
{ q: "ƒê·ªçc s√°ch h√¥m nay ƒë·ªÉ d·∫´n ƒë·∫ßu ng√†y mai.", a: "Margaret Fuller" },
{ q: "Tri th·ª©c l√† s·ª©c m·∫°nh th·ª±c s·ª± c·ªßa con ng∆∞·ªùi.", a: "Francis Bacon" },
{ q: "S√°ch kh√¥ng ch·ªâ d·∫°y ta ki·∫øn th·ª©c m√† c√≤n d·∫°y ta c√°ch suy nghƒ©.", a: "Albert Einstein" },
{ q: "ƒê·ªçc s√°ch l√† ƒë·∫ßu t∆∞ th·∫ßm l·∫∑ng nh∆∞ng sinh l·ª£i su·ªët ƒë·ªùi.", a: "Warren Buffett" }
      ]
    };

    /***********************
     * STATE
     ***********************/
    const S = {
      user: "",
      avatar: "M",
      progress: null, // {points, days}
      currentDay: 1,
      adminPass: ""
    };

    /***********************
     * DOM
     ***********************/
    const el = (id)=>document.getElementById(id);
    const screenLogin = el("screenLogin");
    const screenHome  = el("screenHome");
    const screenDay   = el("screenDay");
    const screenAdmin = el("screenAdmin");

    const btnBack   = el("btnBack");
    const btnLogout = el("btnLogout");
    const btnAdminTop = el("btnAdminTop");
    const btnUserTag = el("btnUserTag");

    const toast = el("toast");

    /***********************
     * Toast
     ***********************/
    let toastTimer = null;
    function showToast(msg, type=""){
      toast.className = "toast show " + (type || "");
      toast.textContent = msg;
      clearTimeout(toastTimer);
      toastTimer = setTimeout(()=>{ toast.className = "toast"; }, 1600);
    }

    /***********************
     * JSONP helper (works for file:// and avoids CORS)
     ***********************/
    function jsonp(url, params = {}) {
      return new Promise((resolve, reject) => {
        const cbName = "cb_" + Date.now() + "_" + Math.floor(Math.random()*100000);
        const qs = new URLSearchParams();
        Object.entries(params).forEach(([k,v]) => {
          if (v === undefined || v === null) return;
          qs.set(k, String(v));
        });
        qs.set("callback", cbName);

        const src = url + (url.includes("?") ? "&" : "?") + qs.toString();
        const script = document.createElement("script");
        script.src = src;
        script.async = true;

        const timeout = setTimeout(() => {
          cleanup();
          reject(new Error("Timeout"));
        }, 20000);

        window[cbName] = (data) => {
          clearTimeout(timeout);
          cleanup();
          resolve(data);
        };

        script.onerror = () => {
          clearTimeout(timeout);
          cleanup();
          reject(new Error("JSONP error"));
        };

        function cleanup(){
          try { delete window[cbName]; } catch(e){ window[cbName]=undefined; }
          if (script.parentNode) script.parentNode.removeChild(script);
        }

        document.body.appendChild(script);
      });
    }

    function apiGet(action, params = {}) {
      return jsonp(CONFIG.WEB_APP_URL, { action, ...params });
    }

    function apiSave(user, day, content) {
      // MUST use GET save for no-CORS (c√°ch 2)
      return jsonp(CONFIG.WEB_APP_URL, { action:"save", user, day, content });
    }

    function apiPostJSON(body){
      // Some browsers block fetch from file://; keep only for optional admin reset.
      return fetch(CONFIG.WEB_APP_URL, {
        method: "POST",
        headers: { "Content-Type":"application/json" },
        body: JSON.stringify(body)
      }).then(r=>r.json());
    }

    /***********************
     * Session storage
     ***********************/
    function loadSession(){
      const raw = localStorage.getItem("d2r_session_v3");
      if (!raw) return false;
      try{
        const j = JSON.parse(raw);
        if (j && j.user){
          S.user = j.user;
          S.avatar = j.avatar || "M";
          return true;
        }
      }catch(e){}
      return false;
    }
    function saveSession(){
      localStorage.setItem("d2r_session_v3", JSON.stringify({ user:S.user, avatar:S.avatar }));
    }
    function clearSession(){
      localStorage.removeItem("d2r_session_v3");
      S.user = "";
      S.avatar = "M";
      S.progress = null;
      S.currentDay = 1;
    }

    /***********************
     * Screen helpers
     ***********************/
    function setTopActions(mode){
      // mode: login | home | day | admin
      btnBack.classList.toggle("hide", !(mode==="day" || mode==="admin"));
      btnLogout.classList.toggle("hide", !(mode==="home" || mode==="day" || mode==="admin"));
      btnAdminTop.classList.toggle("hide", !(mode==="home"));
      btnUserTag.classList.toggle("hide", !(mode==="home" || mode==="day"));
      if (mode==="home" || mode==="day"){
        btnUserTag.textContent = "üë§ " + S.user;
      }
    }
    function showScreen(name){
      screenLogin.classList.add("hide");
      screenHome.classList.add("hide");
      screenDay.classList.add("hide");
      screenAdmin.classList.add("hide");

      if (name==="login"){ screenLogin.classList.remove("hide"); setTopActions("login"); }
      if (name==="home"){ screenHome.classList.remove("hide"); setTopActions("home"); }
      if (name==="day"){ screenDay.classList.remove("hide"); setTopActions("day"); }
      if (name==="admin"){ screenAdmin.classList.remove("hide"); setTopActions("admin"); }
    }

    /***********************
     * Business: progress/current day rule
     * - Kh√¥ng nh·∫£y ng√†y: ch·ªâ cho v√†o ƒë√∫ng currentDay (ng√†y nh·ªè nh·∫•t ch∆∞a ho√†n th√†nh).
     ***********************/
    function computeCurrentDay(progress){
      const done = new Set(Object.keys((progress && progress.days) || {}).map(k => Number(k)));
      for (let d=1; d<=CONFIG.MAX_DAYS; d++){
        if (!done.has(d)) return d;
      }
      return CONFIG.MAX_DAYS; // all done -> keep last
    }

    /***********************
     * Render: Home
     ***********************/
    async function loadHome(){
      showScreen("home");
      el("helloTitle").innerHTML = `Xin ch√†o, <b>${escapeHtml(S.user)}</b> ‚ú®`;
      btnAdminTop.classList.remove("hide");

      showToast("ƒêang t·∫£i d·ªØ li·ªáu...", "warn");

      // progress
      const res = await apiGet("get", { user: S.user }).catch(()=>null);
      if (!res || !res.ok){
        showToast("Kh√¥ng t·∫£i ƒë∆∞·ª£c progress", "err");
        return;
      }
      S.progress = res.progress || { points:0, days:{} };
      S.currentDay = computeCurrentDay(S.progress);

      // leaderboard
      const lb = await apiGet("leaderboard", { user: S.user, top: CONFIG.LEADERBOARD_TOP }).catch(()=>null);

      renderHome(S.progress, lb);
      showToast("S·∫µn s√†ng", "ok");
    }

    function renderHome(progress, lb){
      const points = Number(progress.points || 0) || 0;
      el("pointBadge").textContent = `‚≠ê ƒêi·ªÉm: ${points}`;
      el("mePoint").textContent = String(points);
      el("currentDay").textContent = String(S.currentDay);

      // rank info
      if (lb && lb.ok && lb.me){
        el("meRank").textContent = lb.me.rank ? ("#" + lb.me.rank) : "-";
        el("meRankLine").textContent = lb.me.rank ? (`H·∫°ng #${lb.me.rank} ‚Ä¢ ${lb.me.points || 0} ƒëi·ªÉm`) : `Ch∆∞a c√≥ h·∫°ng`;
      } else {
        el("meRank").textContent = "-";
        el("meRankLine").textContent = "-";
      }

      // grid days
      const grid = el("dayGrid");
      grid.innerHTML = "";
      const done = new Set(Object.keys(progress.days||{}).map(k=>Number(k)));
      for (let d=1; d<=CONFIG.MAX_DAYS; d++){
        const isDone = done.has(d);
        const isCurrent = (d === S.currentDay);
        const locked = (!isCurrent); // only current day allowed

        const box = document.createElement("div");
        box.className = "day" + (isDone ? " completed" : "") + (isCurrent ? " current" : "") + (locked ? " locked" : "");
        box.innerHTML = `
          <div class="tick" aria-hidden="true"></div>
          <div class="d">Ng√†y ${d}</div>
          <div class="s">${isDone ? "ƒê√£ ho√†n th√†nh" : (isCurrent ? "V√†o ng√†y n√†y" : "Ch∆∞a t·ªõi")}</div>
        `;
        box.addEventListener("click", () => {
          if (locked) {
            showToast("B·∫°n ch·ªâ ƒë∆∞·ª£c v√†o ƒë√∫ng ng√†y hi·ªán t·∫°i", "warn");
            return;
          }
          openDay(d);
        });
        grid.appendChild(box);
      }

      // leaderboard under journey
      el("lbMeta").textContent = `Top ${CONFIG.LEADERBOARD_TOP}`;
      const rows = el("lbRows");
      rows.innerHTML = "";

      if (lb && lb.ok && Array.isArray(lb.top) && lb.top.length){
        lb.top.forEach((it, idx) => {
          const r = document.createElement("div");
          r.className = "lbRow";
          r.innerHTML = `
            <div class="rk">${idx+1}</div>
            <div class="u">${escapeHtml(it.user || "")}</div>
            <div class="p">
              <span class="star">${starSvg()}</span>
              <span>${Number(it.points||0)}</span>
            </div>
          `;
          rows.appendChild(r);
        });
      } else {
        const r = document.createElement("div");
        r.className = "lbRow";
        r.innerHTML = `<div class="rk">-</div><div class="u muted">Ch∆∞a c√≥ d·ªØ li·ªáu</div><div class="p">-</div>`;
        rows.appendChild(r);
      }
    }

    /***********************
     * Render: Day screen
     ***********************/
    function openDay(day){
      showScreen("day");
      // IMPORTANT: re-enable finish button for the new day
      el("btnFinish").disabled = false;
      el("dayTitle").textContent = "Ng√†y " + day;

      // quote
      const q = CONFIG.QUOTES[Math.floor(Math.random()*CONFIG.QUOTES.length)];
      el("quoteBox").innerHTML = `‚Äú${escapeHtml(q.q)}‚Äù<small>‚Äî ${escapeHtml(q.a)}</small>`;

      // preload content if already exists (shouldn't happen for current day, but keep safe)
      const old = (S.progress && S.progress.days && S.progress.days[String(day)]) ? (S.progress.days[String(day)].content || "") : "";
      el("txtContent").value = old || "";

      el("btnFinish").onclick = async () => {
        const content = el("txtContent").value.trim();
        if (content.length < CONFIG.MIN_LEN){
          showToast(`N·ªôi dung t·ªëi thi·ªÉu ${CONFIG.MIN_LEN} k√Ω t·ª±`, "warn");
          return;
        }
        el("btnFinish").disabled = true;
        showToast("ƒêang l∆∞u...", "warn");

        try{
          const res = await apiSave(S.user, day, content);
          if (!res || !res.ok){
            showToast(res && res.error ? res.error : "L∆∞u th·∫•t b·∫°i", "err");
            el("btnFinish").disabled = false;
            return;
          }
          showToast("ƒê√£ l∆∞u! Quay v·ªÅ trang ch·ªß‚Ä¶", "ok");

          // reload home to reflect points/rank
          setTimeout(()=> loadHome(), 350);
        }catch(e){
          showToast("L∆∞u th·∫•t b·∫°i (timeout)", "err");
          el("btnFinish").disabled = false;
        }
      };

      btnBack.onclick = () => loadHome();
    }

    /***********************
     * Admin
     ***********************/
    function openAdmin(){
      showScreen("admin");
      el("inpAdminPass").value = S.adminPass || "";
      el("inpWebAppUrl").value = CONFIG.WEB_APP_URL;

      // tabs
      document.querySelectorAll(".tab").forEach(t=>{
        t.onclick = () => setAdminTab(t.dataset.tab);
      });

      el("btnReloadDash").onclick = () => adminLoadDashboard(true);
      el("btnLoadAccounts").onclick = () => adminLoadAccounts();
      el("btnCopyUrl").onclick = async () => {
        try{ await navigator.clipboard.writeText(CONFIG.WEB_APP_URL); showToast("ƒê√£ copy URL", "ok"); }
        catch(e){ showToast("Kh√¥ng copy ƒë∆∞·ª£c", "err"); }
      };
      el("btnTestPing").onclick = async () => {
        showToast("ƒêang test ping‚Ä¶", "warn");
        const r = await apiGet("ping", {}).catch(()=>null);
        showToast(r && r.ok ? "Ping OK" : "Ping l·ªói", (r && r.ok) ? "ok" : "err");
      };
      el("btnTestDash").onclick = async () => {
        const pass = el("inpAdminPass").value.trim();
        if (!pass){ showToast("Nh·∫≠p admin password", "warn"); return; }
        showToast("ƒêang test dashboard‚Ä¶", "warn");
        const r = await apiGet("dashboard", { adminPass: pass }).catch(()=>null);
        showToast(r && r.ok ? "Dashboard OK" : "Dashboard l·ªói", (r && r.ok) ? "ok" : "err");
      };

      el("btnResetUser").onclick = async () => {
        const pass = el("inpAdminPass").value.trim();
        const u = normalizeUser(el("inpResetUser").value);
        if (!pass){ showToast("Nh·∫≠p admin password", "warn"); return; }
        if (!u){ showToast("Nh·∫≠p user c·∫ßn reset", "warn"); return; }
        showToast("ƒêang reset‚Ä¶", "warn");
        try{
          // POST may be blocked by file:// in some browsers; still attempt.
          const r = await apiPostJSON({ action:"account.resetprogress", adminPass: pass, user: u }).catch(()=>null);
          if (r && r.ok){
            showToast("Reset OK", "ok");
            adminLoadDashboard(true);
          } else {
            showToast("Reset l·ªói (n·∫øu m·ªü file:// c√≥ th·ªÉ b·ªã ch·∫∑n POST)", "err");
          }
        }catch(e){
          showToast("Reset l·ªói", "err");
        }
      };

      // default tab & load
      setAdminTab("dash");
      adminLoadDashboard(false);
    }

    function setAdminTab(tab){
      document.querySelectorAll(".tab").forEach(t => t.classList.toggle("active", t.dataset.tab===tab));
      el("adminDash").classList.toggle("hide", tab!=="dash");
      el("adminAcc").classList.toggle("hide", tab!=="acc");
      el("adminWeb").classList.toggle("hide", tab!=="web");
      el("adminReset").classList.toggle("hide", tab!=="reset");
    }

    async function adminLoadDashboard(force){
      const pass = el("inpAdminPass").value.trim();
      S.adminPass = pass;
      if (!pass){
        showToast("Nh·∫≠p admin password ƒë·ªÉ xem dashboard", "warn");
        el("dashBody").innerHTML = "";
        el("dayStatBody").innerHTML = "";
        el("dashMeta").textContent = "";
        return;
      }

      showToast(force ? "ƒêang t·∫£i l·∫°i dashboard‚Ä¶" : "ƒêang t·∫£i dashboard‚Ä¶", "warn");

      const r = await apiGet("dashboard", { adminPass: pass }).catch(()=>null);
      if (!r || !r.ok){
        showToast((r && r.error) ? r.error : "Kh√¥ng t·∫£i ƒë∆∞·ª£c dashboard", "err");
        return;
      }

      // ranking rows
      const ranking = Array.isArray(r.ranking) ? r.ranking : (Array.isArray(r.leaderboard) ? r.leaderboard : []);
      const tb = el("dashBody");
      tb.innerHTML = "";

      if (ranking.length){
        ranking.slice(0, 200).forEach((it, idx)=>{
          const tr = document.createElement("tr");
          const points = Number(it.points||0);
          const reachedText = it.reachedAtText || (it.reachedAt ? fmtTime(it.reachedAt) : "-");
          tr.innerHTML = `
            <td><b>${idx+1}</b></td>
            <td><b>${escapeHtml(it.user || it.user)}</b></td>
            <td class="center">‚≠ê <b>${points}</b></td>
            <td>${escapeHtml(reachedText)}</td>
          `;
          tb.appendChild(tr);
        });
      } else {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td colspan="4" class="muted">Ch∆∞a c√≥ d·ªØ li·ªáu</td>`;
        tb.appendChild(tr);
      }

      // byDay stats
      const stats = Array.isArray(r.dayStats) ? r.dayStats : (Array.isArray(r.byDay) ? r.byDay : []);
      const sb = el("dayStatBody");
      sb.innerHTML = "";
      for (let d=1; d<=CONFIG.MAX_DAYS; d++){
        const found = stats.find(x => Number(x.day)===d);
        const count = found ? Number(found.count||0) : 0;
        const tr = document.createElement("tr");
        tr.innerHTML = `<td><b>Ng√†y ${d}</b></td><td class="right"><b>${count}</b></td>`;
        sb.appendChild(tr);
      }

      el("dashMeta").textContent =
        `T·ªïng user: ${Number(r.totalUsers||0)} ‚Ä¢ T·ªïng log: ${Number(r.totalLogs||0)} ‚Ä¢ C·∫≠p nh·∫≠t: ${fmtTime(r.generatedAt||Date.now())}`;

      showToast("Dashboard OK", "ok");
    }

    async function adminLoadAccounts(){
      const pass = el("inpAdminPass").value.trim();
      S.adminPass = pass;
      if (!pass){ showToast("Nh·∫≠p admin password", "warn"); return; }

      showToast("ƒêang t·∫£i Accounts‚Ä¶", "warn");
      const r = await apiGet("account.list", { adminPass: pass }).catch(()=>null);
      if (!r || !r.ok){
        showToast((r && r.error) ? r.error : "Kh√¥ng t·∫£i ƒë∆∞·ª£c Accounts", "err");
        return;
      }
      const body = el("accBody");
      body.innerHTML = "";
      const list = Array.isArray(r.accounts) ? r.accounts : [];
      if (!list.length){
        const tr = document.createElement("tr");
        tr.innerHTML = `<td colspan="2" class="muted">Ch∆∞a c√≥ account</td>`;
        body.appendChild(tr);
      } else {
        list.slice(0, 300).forEach(a=>{
          const tr = document.createElement("tr");
          tr.innerHTML = `<td><b>${escapeHtml(a.user||"")}</b></td><td class="center"><b>${escapeHtml(a.avatar||"M")}</b></td>`;
          body.appendChild(tr);
        });
      }
      showToast("Accounts OK", "ok");
    }

    /***********************
     * Login/Logout
     ***********************/
    el("btnLogin").onclick = async () => {
      const user = normalizeUser(el("inpUser").value);
      const pass = (el("inpPass").value || "").trim();
      if (!user){ showToast("Nh·∫≠p t√†i kho·∫£n", "warn"); return; }
      if (!pass){ showToast("Nh·∫≠p m·∫≠t kh·∫©u", "warn"); return; }

      showToast("ƒêang ƒëƒÉng nh·∫≠p‚Ä¶", "warn");
      const r = await apiGet("auth", { user, password: pass }).catch(()=>null);

      if (!r || !r.ok){
        showToast((r && r.error) ? r.error : "ƒêƒÉng nh·∫≠p th·∫•t b·∫°i", "err");
        return;
      }

      S.user = r.user;
      S.avatar = r.avatar || "M";
      saveSession();
      showToast("ƒêƒÉng nh·∫≠p OK", "ok");
      loadHome();
    };

    el("btnOpenAdminFromLogin").onclick = () => openAdmin();
    btnAdminTop.onclick = () => openAdmin();

    btnLogout.onclick = () => {
      clearSession();
      showToast("ƒê√£ ƒëƒÉng xu·∫•t", "ok");
      showScreen("login");
      // clear inputs
      el("inpPass").value = "";
    };

    btnBack.onclick = () => showScreen("home");

    /***********************
     * Topbar mini
     ***********************/
    btnUserTag.onclick = () => {
      // Quick refresh home
      if (!screenHome.classList.contains("hide")) loadHome();
    };

    /***********************
     * Helpers
     ***********************/
    function normalizeUser(s){
      return String(s||"").trim().replace(/\s+/g,"").replace(/@vietinbank\.vn$/i,"");
    }
    function escapeHtml(s){
      return String(s||"").replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
    }
    function fmtTime(ms){
      try{
        const d = new Date(Number(ms)||Date.now());
        const pad = n => String(n).padStart(2,"0");
        return `${pad(d.getHours())}:${pad(d.getMinutes())}:${pad(d.getSeconds())} ${pad(d.getDate())}/${pad(d.getMonth()+1)}/${d.getFullYear()}`;
      }catch(e){ return "-"; }
    }
    function starSvg(){
      return `
        <svg viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M12 2.5l2.9 6.2 6.8.6-5.1 4.4 1.5 6.6L12 16.9 5.9 20.3l1.5-6.6-5.1-4.4 6.8-.6L12 2.5z"
            fill="rgba(245,158,11,.95)" stroke="rgba(245,158,11,.95)" stroke-width="0.6"/>
        </svg>`;
    }

    /***********************
     * Init
     ***********************/
    (function init(){
      // Put URL into admin web tab
      el("inpWebAppUrl").value = CONFIG.WEB_APP_URL;
      el("webHint").textContent = "N·∫øu ƒë·ªïi deploy URL, ch·ªâ c·∫ßn s·ª≠a CONFIG.WEB_APP_URL trong file HTML n√†y.";

      // route
      if (loadSession()){
        showToast("ƒêang kh√¥i ph·ª•c phi√™n‚Ä¶", "warn");
        loadHome();
      } else {
        showScreen("login");
      }
    })();
  </script>
</body>
</html>
